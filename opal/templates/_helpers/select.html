{% load forms %}
<div class="form-group"
     {% if visibility %} {{ visibility|safe }} {% endif %}
     >
    <span ng-class="{ 'errored-state': {{ form_name }}.{{ modelname }}.$dirty && !{{ form_name }}.{{ modelname }}.$valid }">
    <label class="control-label col-sm-3">
      {{ label }}
    </label>
  <div class="col-sm-8">
    {% if search_select %}
      <ui-select {% if change %} ng-change={{ change }} {% endif %}{% if disabled %}ng-disabled="{{ disabled }}" {% endif %}name="{{ modelname }}" required="{{ required }}" ng-model="{{ model }}" theme="bootstrap" style="min-width: 300px;" reset-search-input="false">
        <ui-select-match {% if placeholder %}placeholder="{{ placeholder }}"{% endif %}>[[ $select.selected ]]</ui-select-match>
        <ui-select-choices repeat="i in {{ lookuplist }} | filter:$select.search track by $index">
          <div ng-bind-html="i | highlight: $select.search"></div>
        </ui-select-choices>
      </ui-select>
    {% else %}
      <select name="{{ modelname }}" ng-required="{{ required }}" class="form-control" ng-model="{{ model }}" {% if change %} ng-change={{ change }} {% endif %} {% if disabled %}ng-disabled="{{ disabled }}" {% endif %}>
        <option value="">---------</option>
        <option ng-repeat="i in {{ lookuplist }}">[[ i ]]</option>
        {% if other %}<option>Other</option>{% endif %}
      </select>
    {% endif %}
    {% if required %}
      <span ng-show="{{ form_name }}.{{ modelname }}.$dirty && {{ form_name }}.{{ modelname }}.$error.required">
        {{ required }}
      </span>
    {% endif %}
    {% if help_template %}
    <p class="text-muted pointer"
       title="Help"
       data-placement="bottom"
       data-auto-close="true"
       data-template-url="{{ help_template }}"
       name="{{ model }}"
       bs-popover
       >
        <i class="fa fa-question-circle"></i>
        More details about {{ label }}
    </p>
    <script type="text/ng-template" id="{{ help_template }}">
      <div class="popover">
        <div class="arrow"></div>
        <h3 class="popover-title" ng-bind="title" ng-show="title"></h3>
        <div class="popover-content">
          {% include help_template %}
        </div>
      </div>
    </script>
    {% endif %}
  </div>
  </span>
</div>
{% if other %}
{% input model=model label=other_label show=other_show  %}
{% endif %}
