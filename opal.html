<!doctype html>
<html ng-app="opalApp" ng-controller="TableCtrl" ng-keydown="keypress($event)">
	<head>
		<meta charset="utf-8">
		<title>OPAL is not a Patient Activity List</title>
		<script src="assets/js/jquery-1.9.1.js"></script>
		<script src="assets/js/angular-1.1.5.js"></script>
		<script src="assets/js/bootstrap-2.3.1.js"></script>
		<script src="assets/js/angular-strap-0.7.4.js"></script>
		<script src="assets/js/opal.js"></script>
		<link href="assets/css/bootstrap-2.3.1.css" rel="stylesheet" media="screen">
		<link href="assets/css/opal.css" rel="stylesheet" media="screen">
	</head>
	<body>
		<h1>OPAL is not a Patient Activity List</h1>
		<table class="table table-bordered">
			<thead>
				<tr>
					<th>Location</th>
					<th>Demographics</th>
					<th>Diagnosis</th>
					<th>Past Medical History</th>
					<th>Travel</th>
					<th>Antibiotics</th>
					<th>Microbiology Comments</th>
					<th>Plan</th>
					<th>Discharge</th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="row in rows" ng-class="{selected: row._selected}">
					<td ng-class="{selected: selectedColumnName == 'location'}">
						<ul>
							<li class="selected">{{row.location.category}}<br /><span ng-hide="row.location.hospital=='UCH'">{{row.location.hospital}} </span>{{row.location.ward}} {{row.location.bed}}<br />Admitted: {{row.location.dateOfAdmission}}</li>
						</ul>
					</td>

					<td ng-class="{selected: selectedColumnName == 'demographics'}">
						<ul>
							<li class="selected">{{row.demographics.name}}<br />{{row.demographics.hospitalNumber}}<br />{{row.demographics.dateOfBirth}}</li>
						</ul>
					</td>

					<td ng-class="{selected: selectedColumnName == 'diagnosis'}">
						<ul>
							<li ng-repeat="diagnosis in row.diagnosis" ng-class="{selected: diagnosis._selected}">
								<span ng-hide="diagnosis._new">
									<span ng-hide="diagnosis.confirmed">?</span>
									{{diagnosis.condition}}
									<span ng-show="diagnosis.details">({{diagnosis.details}})</span>
								</span>
								<span ng-show="row._selected && diagnosis._new">[Add diagnosis]</span>
							</li>
						</ul>
					</td>

					<td ng-class="{selected: selectedColumnName == 'pastMedicalHistory'}">
						<ul>
							<li ng-repeat="pmh in row.pastMedicalHistory" ng-class="{selected: pmh._selected}">
								<span ng-hide="pmh._new">
									{{pmh.condition}} <span ng-show="pmh.year">({{pmh.year}})</span>
								</span>
								<span ng-show="row._selected && pmh._new">[Add condition]</span>
							</li>
						</ul>
					</td>

					<td ng-class="{selected: selectedColumnName == 'travel'}">
						<ul>
							<li ng-repeat="trip in row.travel" ng-class="{selected: trip._selected}">
								<span ng-hide="trip._new">
									{{trip.destination}}
								   	<span ng-show="trip.dates">({{trip.dates}})</span>
								   	{{trip.reason}}
									<span ng-show="trip.reason && trip.specificExposures">/</span>
								   	{{trip.specificExposures}}
								</span>
								<span ng-show="row._selected && trip._new">[Add trip]</span>
							</li>
						</ul>
					</td>

					<td ng-class="{selected: selectedColumnName == 'antibiotics'}">
						<ul>
							<li ng-repeat="antibiotic in row.antibiotics" ng-class="{selected: antibiotic._selected}">
								<span ng-hide="antibiotic._new">
									{{antibiotic.name}}
									<span ng-show="antibiotic.route">/ {{antibiotic.route}}</span>
									({{antibiotic.startDate}} - {{antibiotic.endDate}})
								</span>
								<span ng-show="row._selected && antibiotic._new">[Add antibiotic]</span>
							</li>
						</ul>
					</td>

					<td ng-class="{selected: selectedColumnName == 'microbiologyComments'}">
						<ul>
							<li ng-repeat="comment in row.microbiologyComments" ng-class="{selected: comment._selected}">
								<span ng-hide="comment._new">
									{{comment.date}}
									[{{comment.initials}}]
									{{comment.comment}}
								</span>
								<span ng-show="row._selected && comment._new">[Add comment]</span>
							</li>
						</ul>
					</td>

					<td ng-class="{selected: selectedColumnName == 'plan'}">
						<ul>
							<li class="selected preserve-whitespace">{{row.plan}}</li>
						</ul>
					</td>

					<td ng-class="{selected: selectedColumnName == 'discharge'}">
						<ul>
							<li class="selected preserve-whitespace">{{row.discharge}}</li>
						</ul>
					</td>
				</tr>
			</tbody>
		</table>

		<div id="location-modal" class="modal hide" tabindex="-1" role="dialog">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" ng-click="cancelEdit()">×</button>
				<h3>Location</h3>
			</div>
			<div class="modal-body">
				<form class="form-horizontal">
					<div class="control-group">
						<label class="control-label">Hospital</label>
						<div class="controls">
							<input type="text" ng-model="editing.hospital">
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">Ward</label>
						<div class="controls">
							<input type="text" ng-model="editing.ward">
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">Bed</label>
						<div class="controls">
							<input type="text" ng-model="editing.bed">
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">Date of admission</label>
						<div class="controls">
							<input type="text" ng-model="editing.dateOfAdmission">
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button class="btn" data-dismiss="modal" ng-click="cancelEdit()">Cancel</button>
				<button class="btn btn-primary" data-dismiss="modal" ng-click="saveEdit()">Save changes</button>
			</div>
		</div>
		
		<div id="demographics-modal" class="modal hide" tabindex="-1" role="dialog">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" ng-click="cancelEdit()">×</button>
				<h3>Demographics</h3>
			</div>
			<div class="modal-body">
				<form class="form-horizontal">
					<div class="control-group">
						<label class="control-label">Name</label>
						<div class="controls">
							<input type="text" ng-model="editing.name">
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">Hospital number</label>
						<div class="controls">
							<input type="text" ng-model="editing.hospitalNumber">
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">Date of birth</label>
						<div class="controls">
							<input type="text" ng-model="editing.dateOfBirth">
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button class="btn" data-dismiss="modal" ng-click="cancelEdit()">Cancel</button>
				<button class="btn btn-primary" data-dismiss="modal" ng-click="saveEdit()">Save changes</button>
			</div>
		</div>
		
		<div id="diagnosis-modal" class="modal hide" tabindex="-1" role="dialog">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" ng-click="cancelEdit()">×</button>
				<h3>Diagnosis</h3>
			</div>
			<div class="modal-body">
				<form class="form-horizontal">
					<div class="control-group">
						<label class="control-label">Condition</label>
						<div class="controls">
							<input type="text" ng-model="editing.condition" bs-typeahead="conditions" data-provide="typeahead">
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">Confirmed?</label>
						<div class="controls">
							<input type="checkbox" ng-model="editing.confirmed">
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">Details</label>
						<div class="controls">
							<input type="text" ng-model="editing.details" bs-typeahead="subconditions" data-provide="typeahead">
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button class="btn" data-dismiss="modal" ng-click="cancelEdit()">Cancel</button>
				<button class="btn btn-primary" data-dismiss="modal" ng-click="saveEdit()">Save changes</button>
			</div>
		</div>
		
		<div id="pastMedicalHistory-modal" class="modal hide" tabindex="-1" role="dialog">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" ng-click="cancelEdit()">×</button>
				<h3>Past Medical History</h3>
			</div>
			<div class="modal-body">
				<form class="form-horizontal">
					<div class="control-group">
						<label class="control-label">Condition</label>
						<div class="controls">
							<input type="text" ng-model="editing.condition">
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">Year</label>
						<div class="controls">
							<input type="text" ng-model="editing.year">
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button class="btn" data-dismiss="modal" ng-click="cancelEdit()">Cancel</button>
				<button class="btn btn-primary" data-dismiss="modal" ng-click="saveEdit()">Save changes</button>
			</div>
		</div>
		
		<div id="travel-modal" class="modal hide" tabindex="-1" role="dialog">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" ng-click="cancelEdit()">×</button>
				<h3>Travel</h3>
			</div>
			<div class="modal-body">
				<form class="form-horizontal">
					<div class="control-group">
						<label class="control-label">Destination</label>
						<div class="controls">
							<input type="text" ng-model="editing.destination" bs-typeahead="destinations" data-provide="typeahead">
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">Dates</label>
						<div class="controls">
							<input type="text" ng-model="editing.dates">
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">Reason for travel</label>
						<div class="controls">
							<input type="text" ng-model="editing.reason">
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">Specific exposures</label>
						<div class="controls">
							<input type="text" ng-model="editing.specificExposures">
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button class="btn" data-dismiss="modal" ng-click="cancelEdit()">Cancel</button>
				<button class="btn btn-primary" data-dismiss="modal" ng-click="saveEdit()">Save changes</button>
			</div>
		</div>
		
		<div id="antibiotics-modal" class="modal hide" tabindex="-1" role="dialog">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" ng-click="cancelEdit()">×</button>
				<h3>Antibiotics</h3>
			</div>
			<div class="modal-body">
				<form class="form-horizontal">
					<div class="control-group">
						<label class="control-label">Drug</label>
						<div class="controls">
							<input type="text" ng-model="editing.name">
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">Route</label>
						<div class="controls">
							<input type="text" ng-model="editing.route">
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">Start date</label>
						<div class="controls">
							<input type="text" ng-model="editing.startDate">
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">End date</label>
						<div class="controls">
							<input type="text" ng-model="editing.endDate">
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button class="btn" data-dismiss="modal" ng-click="cancelEdit()">Cancel</button>
				<button class="btn btn-primary" data-dismiss="modal" ng-click="saveEdit()">Save changes</button>
			</div>
		</div>
		
		<div id="microbiologyComments-modal" class="modal hide" tabindex="-1" role="dialog">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" ng-click="cancelEdit()">×</button>
				<h3>Microbiology Comments</h3>
			</div>
			<div class="modal-body">
				<form class="form-horizontal">
					<div class="control-group">
						<label class="control-label">Date</label>
						<div class="controls">
							<input type="text" ng-model="editing.date">
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">Initials</label>
						<div class="controls">
							<input type="text" ng-model="editing.initials">
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">Comment</label>
						<div class="controls">
							<input type="text" ng-model="editing.comment">
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button class="btn" data-dismiss="modal" ng-click="cancelEdit()">Cancel</button>
				<button class="btn btn-primary" data-dismiss="modal" ng-click="saveEdit()">Save changes</button>
			</div>
		</div>
		
		<div id="plan-modal" class="modal hide" tabindex="-1" role="dialog">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" ng-click="cancelEdit()">×</button>
				<h3>Plan</h3>
			</div>
			<div class="modal-body">
				<form>
					<textarea ng-model="editing" rows="10"></textarea>
				</form>
			</div>
			<div class="modal-footer">
				<button class="btn" data-dismiss="modal" ng-click="cancelEdit()">Cancel</button>
				<button class="btn btn-primary" data-dismiss="modal" ng-click="saveEdit()">Save changes</button>
			</div>
		</div>
		
		<div id="discharge-modal" class="modal hide" tabindex="-1" role="dialog">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" ng-click="cancelEdit()">×</button>
				<h3>Discharge</h3>
			</div>
			<div class="modal-body">
				<form>
					<textarea ng-model="editing" rows="10"></textarea>
				</form>
			</div>
			<div class="modal-footer">
				<button class="btn" data-dismiss="modal" ng-click="cancelEdit()">Cancel</button>
				<button class="btn btn-primary" data-dismiss="modal" ng-click="saveEdit()">Save changes</button>
			</div>
		</div>
	</body>
</html>
